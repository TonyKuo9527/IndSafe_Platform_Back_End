import{r as _}from"./request.60bf0c1b.js";import{_ as q,b as d,w as s,f as o,o as r,a as e,g as x,d as n,c as V,r as E,F as J,e as k,t as p}from"./index.ee0f6373.js";const A={name:"CameraManagement",data(){return{data:[],pages:0,page:1,size:5,createModel:!1,settingsModel:!1,deleteModel:!1,item:{},channelList:[],buffer:!1,toasts:[]}},mounted(){this.checkJWT()},methods:{checkJWT(){if(!this.$store.state.jwt){this.toasts.push({title:"Error",content:"\u767B\u5165\u91D1\u9470\u5DF2\u904E\u671F\uFF0C\u8ACB\u91CD\u65B0\u767B\u5165!"}),this.$router.push("/dashboard");return}_({method:"POST",url:"/auth/checkJWT",headers:{authorization:this.$store.state.jwt}}).then(i=>{i.data.status?this.init():(this.toasts.push({title:"Error",content:"\u767B\u5165\u91D1\u9470\u5DF2\u904E\u671F\uFF0C\u8ACB\u91CD\u65B0\u767B\u5165!"}),this.$router.push("/dashboard"))}).catch(i=>{console.log(i)})},async init(){this.pages=0,this.page=1,this.size=5,await this.getChannelList(),_({method:"GET",url:"/camera"}).then(i=>{let l=i.data;switch(l.status){case 1:let u=[];l.data.length>=25?this.size=15:this.size=5,l.data.forEach((C,t)=>{C.index=t+1,u.push(C)}),this.data=u,this.data.length/this.size>1?this.pages=Math.ceil(this.data.length/this.size):this.pages=1;break;case 0:this.toasts.push({title:"Error",content:"\u7CFB\u7D71\u932F\u8AA4\uFF0C\u8ACB\u8207\u7BA1\u7406\u8005\u806F\u7E6B"});break}}).catch(i=>{this.checkJWT()})},getChannelList(){new Promise((i,l)=>{this.channelList=[],this.channelList.push({label:"\u8ACB\u9078\u64C7ChannelName",value:0}),_({method:"GET",url:"/channel"}).then(u=>{let C=u.data;switch(C.status){case 1:C.data.forEach((t,f)=>{this.channelList.push({label:t.channelName,value:t.id})}),i();break;case 0:this.toasts.push({title:"Error",content:"\u7CFB\u7D71\u932F\u8AA4\uFF0C\u8ACB\u8207\u7BA1\u7406\u8005\u806F\u7E6B"}),l();break}}).catch(u=>{console.log(u),l()})})},showCreateModel(){this.item={cameraID:"",channelID:"",rtsp:"",description:""},this.createModel=!0},showSettingModel(i){this.item=i,this.settingsModel=!0},showDeleteModel(i){this.item=i,this.deleteModel=!0},createCamera(){if(this.buffer)return;if(this.buffer=!0,this.item.cameraID===""||this.item.channelID===""||this.item.channelID==0||this.item.rtsp===""){this.toasts.push({title:"Error",content:"\u8ACB\u8F38\u5165\u5B8C\u6574\u8CC7\u6599"}),this.buffer=!1;return}const i={cameraID:this.item.cameraID,channelID:this.item.channelID,rtsp:this.item.rtsp,description:this.item.description};_({method:"POST",url:"/camera",data:i,headers:{authorization:this.$store.state.jwt}}).then(l=>{switch(l.data.status){case 1:this.toasts.push({title:"Success",content:"\u65B0\u589E\u6210\u529F"}),this.createModel=!1,this.buffer=!1,this.checkJWT();break;case 0:this.toasts.push({title:"Error",content:"\u7CFB\u7D71\u932F\u8AA4\uFF0C\u8ACB\u8207\u7BA1\u7406\u8005\u806F\u7E6B"}),this.createModel=!1,this.buffer=!1,this.checkJWT();break;case 101:this.toasts.push({title:"Error",content:"\u8CC7\u6599\u683C\u5F0F\u932F\u8AA4\uFF0C\u8ACB\u8207\u7BA1\u7406\u8005\u806F\u7E6B!"}),this.createModel=!1,this.buffer=!1,this.checkJWT();break;case 102:this.toasts.push({title:"Error",content:"CameraName\u91CD\u8907!"}),this.item.channelName="";break;case 110:this.toasts.push({title:"Error",content:"\u8CC7\u6599\u4E2D\u5B58\u5728\u9055\u898F\u7684\u7279\u6B8A\u7B26\u865F!"}),this.createModel=!1,this.buffer=!1,this.checkJWT();break;case 121:this.toasts.push({title:"Error",content:"JWT\u932F\u8AA4\uFF0C\u8ACB\u91CD\u65B0\u767B\u5165!"}),this.createModel=!1,this.buffer=!1,this.checkJWT();break}}).catch(l=>{this.checkJWT()})},updateCamera(){if(this.buffer)return;if(this.buffer=!0,this.item.cameraID===""||this.item.channelID===""||this.item.channelID==0||this.item.rtsp===""){this.toasts.push({title:"Error",content:"\u8ACB\u8F38\u5165\u5B8C\u6574\u8CC7\u6599"}),this.buffer=!1;return}const i={id:this.item.id,cameraID:this.item.cameraID,channelID:this.item.channelID,rtsp:this.item.rtsp,description:this.item.description};_({method:"PUT",url:"/camera",data:i,headers:{authorization:this.$store.state.jwt}}).then(l=>{switch(l.data.status){case 1:this.toasts.push({title:"Success",content:"\u66F4\u65B0\u6210\u529F"}),this.settingsModel=!1,this.buffer=!1,this.checkJWT();break;case 0:this.toasts.push({title:"Error",content:"\u7CFB\u7D71\u932F\u8AA4\uFF0C\u8ACB\u8207\u7BA1\u7406\u8005\u806F\u7E6B"}),this.settingsModel=!1,this.buffer=!1,this.checkJWT();break;case 101:this.toasts.push({title:"Error",content:"\u8CC7\u6599\u683C\u5F0F\u932F\u8AA4\uFF0C\u8ACB\u8207\u7BA1\u7406\u8005\u806F\u7E6B!"}),this.settingsModel=!1,this.buffer=!1,this.checkJWT();break;case 102:this.toasts.push({title:"Error",content:"Camera\u4E0D\u5B58\u5728\uFF0C\u8ACB\u91CD\u65B0\u64CD\u4F5C!"}),this.settingsModel=!1,this.buffer=!1,this.checkJWT();break;case 103:this.toasts.push({title:"Error",content:"CameraName\u91CD\u8907!"}),this.item.channelName="",this.buffer=!1;break;case 110:this.toasts.push({title:"Error",content:"\u8CC7\u6599\u4E2D\u5B58\u5728\u9055\u898F\u7684\u7279\u6B8A\u7B26\u865F!"}),this.settingsModel=!1,this.buffer=!1,this.checkJWT();break;case 121:this.toasts.push({title:"Error",content:"JWT\u932F\u8AA4\uFF0C\u8ACB\u91CD\u65B0\u767B\u5165!"}),this.settingsModel=!1,this.buffer=!1,this.checkJWT();break}}).catch(l=>{this.checkJWT()})},deleteCamera(){if(this.buffer)return;this.buffer=!0;const i={id:this.item.id};_({method:"Delete",url:"/camera",data:i,headers:{authorization:this.$store.state.jwt}}).then(l=>{switch(l.data.status){case 1:this.toasts.push({title:"Success",content:"\u522A\u9664\u6210\u529F"}),this.deleteModel=!1,this.buffer=!1,this.checkJWT();break;case 0:this.toasts.push({title:"Error",content:"\u7CFB\u7D71\u932F\u8AA4\uFF0C\u8ACB\u8207\u7BA1\u7406\u8005\u806F\u7E6B"}),this.deleteModel=!1,this.buffer=!1,this.checkJWT();break;case 101:this.toasts.push({title:"Error",content:"\u8CC7\u6599\u683C\u5F0F\u932F\u8AA4\uFF0C\u8ACB\u8207\u7BA1\u7406\u8005\u806F\u7E6B!"}),this.deleteModel=!1,this.buffer=!1,this.checkJWT();break;case 102:this.toasts.push({title:"Error",content:"id\u4E0D\u5B58\u5728\uFF0C\u8ACB\u91CD\u65B0\u64CD\u4F5C!"}),this.deleteModel=!1,this.buffer=!1,this.checkJWT();break;case 110:this.toasts.push({title:"Error",content:"\u8CC7\u6599\u4E2D\u5B58\u5728\u9055\u898F\u7684\u7279\u6B8A\u7B26\u865F!"}),this.deleteModel=!1,this.buffer=!1,this.checkJWT();break;case 121:this.toasts.push({title:"Error",content:"JWT\u932F\u8AA4\uFF0C\u8ACB\u91CD\u65B0\u767B\u5165!"}),this.deleteModel=!1,this.buffer=!1,this.checkJWT();break}}).catch(l=>{this.checkJWT()})}}},K={class:"me-auto fw-bold"};function Q(i,l,u,C,t,f){const c=o("CIcon"),h=o("CButton"),g=o("CTableHeaderCell"),W=o("CTableRow"),B=o("CTableHead"),T=o("CTableDataCell"),N=o("CTableBody"),S=o("CTable"),L=o("CPaginationItem"),U=o("CPagination"),F=o("CCardBody"),M=o("CModalTitle"),D=o("CModalHeader"),m=o("CFormLabel"),b=o("CFormInput"),y=o("CFormSelect"),z=o("CModalBody"),I=o("CModalFooter"),w=o("CModal"),P=o("CToastHeader"),R=o("CToastBody"),H=o("CToast"),j=o("CToaster"),X=o("CCard"),G=o("CRow"),O=o("CContainer");return r(),d(O,null,{default:s(()=>[e(G,null,{default:s(()=>[e(X,null,{default:s(()=>[e(F,null,{default:s(()=>[x("h2",null,[n("Camera Management "),e(h,{onClick:l[0]||(l[0]=a=>f.showCreateModel())},{default:s(()=>[e(c,{name:"cil-plus"}),n(" Create ")]),_:1}),e(h,{onClick:l[1]||(l[1]=a=>f.init())},{default:s(()=>[e(c,{name:"cil-sync"}),n(" Update ")]),_:1})]),e(S,{align:"middle",responsive:""},{default:s(()=>[e(B,null,{default:s(()=>[e(W,null,{default:s(()=>[e(g,{scope:"col",class:"w-20"},{default:s(()=>[n("CameraID")]),_:1}),e(g,{scope:"col",class:"w-20"},{default:s(()=>[n("cameraName")]),_:1}),e(g,{scope:"col",class:"w-20"},{default:s(()=>[n("RTSP")]),_:1}),e(g,{scope:"col",class:"w-20"},{default:s(()=>[n("Description")]),_:1}),e(g,{scope:"col",class:"w-20"})]),_:1})]),_:1}),e(N,null,{default:s(()=>[(r(!0),V(J,null,E(t.data,a=>(r(),d(W,{key:a.index},{default:s(()=>[a.index<=t.page*t.size&&a.index>(t.page-1)*t.size?(r(),d(T,{key:0},{default:s(()=>[n(p(a.cameraID),1)]),_:2},1024)):k("",!0),a.index<=t.page*t.size&&a.index>(t.page-1)*t.size?(r(),d(T,{key:1},{default:s(()=>[n(p(a.channelName),1)]),_:2},1024)):k("",!0),a.index<=t.page*t.size&&a.index>(t.page-1)*t.size?(r(),d(T,{key:2},{default:s(()=>[n(p(a.rtsp),1)]),_:2},1024)):k("",!0),a.index<=t.page*t.size&&a.index>(t.page-1)*t.size?(r(),d(T,{key:3},{default:s(()=>[n(p(a.description),1)]),_:2},1024)):k("",!0),a.index<=t.page*t.size&&a.index>(t.page-1)*t.size?(r(),d(T,{key:4},{default:s(()=>[e(h,{onClick:v=>f.showSettingModel(a)},{default:s(()=>[e(c,{name:"cil-settings"})]),_:2},1032,["onClick"]),e(h,{onClick:v=>f.showDeleteModel(a)},{default:s(()=>[e(c,{name:"cil-trash"})]),_:2},1032,["onClick"])]),_:2},1024)):k("",!0)]),_:2},1024))),128))]),_:1})]),_:1}),t.data.length>0?(r(),d(U,{key:0,align:"end","aria-label":"Page navigation example"},{default:s(()=>[(r(!0),V(J,null,E(t.pages,a=>(r(),d(L,{key:a.index,active:t.page===a,onClick:v=>t.page=a},{default:s(()=>[n(p(a),1)]),_:2},1032,["active","onClick"]))),128))]),_:1})):k("",!0)]),_:1}),e(w,{alignment:"center",size:"lg",visible:t.createModel,onClose:l[8]||(l[8]=()=>{t.createModel=!1})},{default:s(()=>[e(D,null,{default:s(()=>[e(M,null,{default:s(()=>[n("Create Camera")]),_:1})]),_:1}),e(z,null,{default:s(()=>[e(m,null,{default:s(()=>[n("CameraID")]),_:1}),e(b,{id:"CameraID",modelValue:t.item.cameraID,"onUpdate:modelValue":l[2]||(l[2]=a=>t.item.cameraID=a)},null,8,["modelValue"]),e(m,null,{default:s(()=>[n("Channel")]),_:1}),e(y,{id:"Channel",modelValue:t.item.channelID,"onUpdate:modelValue":l[3]||(l[3]=a=>t.item.channelID=a),options:t.channelList},null,8,["modelValue","options"]),e(m,null,{default:s(()=>[n("Rtsp")]),_:1}),e(b,{id:"Rtsp",modelValue:t.item.rtsp,"onUpdate:modelValue":l[4]||(l[4]=a=>t.item.rtsp=a)},null,8,["modelValue"]),e(m,null,{default:s(()=>[n("Description")]),_:1}),e(b,{id:"Description",modelValue:t.item.description,"onUpdate:modelValue":l[5]||(l[5]=a=>t.item.description=a)},null,8,["modelValue"])]),_:1}),e(I,null,{default:s(()=>[e(h,{color:"info",onClick:l[6]||(l[6]=a=>f.createCamera()),disabled:t.buffer},{default:s(()=>[e(c,{name:"cil-plus"}),n(" Create")]),_:1},8,["disabled"]),e(h,{color:"secondary",onClick:l[7]||(l[7]=()=>{t.createModel=!1})},{default:s(()=>[e(c,{name:"cil-X"}),n(" Close ")]),_:1})]),_:1})]),_:1},8,["visible"]),e(w,{alignment:"center",size:"lg",visible:t.settingsModel,onClose:l[15]||(l[15]=()=>{t.settingsModel=!1})},{default:s(()=>[e(D,null,{default:s(()=>[e(M,null,{default:s(()=>[n("Setting Camera")]),_:1})]),_:1}),e(z,null,{default:s(()=>[e(m,null,{default:s(()=>[n("CameraID")]),_:1}),e(b,{id:"CameraID",modelValue:t.item.cameraID,"onUpdate:modelValue":l[9]||(l[9]=a=>t.item.cameraID=a)},null,8,["modelValue"]),e(m,null,{default:s(()=>[n("Channel")]),_:1}),e(y,{id:"Channel",modelValue:t.item.channelID,"onUpdate:modelValue":l[10]||(l[10]=a=>t.item.channelID=a),options:t.channelList},null,8,["modelValue","options"]),e(m,null,{default:s(()=>[n("Rtsp")]),_:1}),e(b,{id:"Rtsp",modelValue:t.item.rtsp,"onUpdate:modelValue":l[11]||(l[11]=a=>t.item.rtsp=a)},null,8,["modelValue"]),e(m,null,{default:s(()=>[n("Description")]),_:1}),e(b,{id:"Description",modelValue:t.item.description,"onUpdate:modelValue":l[12]||(l[12]=a=>t.item.description=a)},null,8,["modelValue"])]),_:1}),e(I,null,{default:s(()=>[e(h,{color:"info",onClick:l[13]||(l[13]=a=>f.updateCamera()),disabled:t.buffer},{default:s(()=>[e(c,{name:"cil-settings"}),n(" Update")]),_:1},8,["disabled"]),e(h,{color:"secondary",onClick:l[14]||(l[14]=()=>{t.settingsModel=!1})},{default:s(()=>[e(c,{name:"cil-X"}),n(" Close ")]),_:1})]),_:1})]),_:1},8,["visible"]),e(w,{size:"sm",alignment:"center",visible:t.deleteModel,onClose:l[18]||(l[18]=()=>{t.deleteModel=!1})},{default:s(()=>[e(D,null,{default:s(()=>[e(M,null,{default:s(()=>[n("Delete Camera")]),_:1})]),_:1}),e(I,null,{default:s(()=>[e(h,{color:"danger",onClick:l[16]||(l[16]=a=>f.deleteCamera()),disabled:t.buffer},{default:s(()=>[e(c,{name:"cil-trash"}),n(" Delete")]),_:1},8,["disabled"]),e(h,{color:"secondary",onClick:l[17]||(l[17]=()=>{t.deleteModel=!1})},{default:s(()=>[e(c,{name:"cil-X"}),n(" Close ")]),_:1})]),_:1})]),_:1},8,["visible"]),e(j,{placement:"top-end"},{default:s(()=>[(r(!0),V(J,null,E(t.toasts,a=>(r(),d(H,{key:a.index,delay:3e3},{default:s(()=>[e(P,{closeButton:""},{default:s(()=>[x("span",K,p(a.title),1)]),_:2},1024),e(R,null,{default:s(()=>[n(p(a.content),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})}const $=q(A,[["render",Q]]);export{$ as default};

import{r as C}from"./request.60bf0c1b.js";import{_ as q,b as h,w as t,f as a,o as r,a as e,g as V,d as o,c as y,r as v,F as z,e as b,t as m}from"./index.ee0f6373.js";const G={name:"ChannelManagement",data(){return{data:[],pages:0,page:1,size:5,createModel:!1,settingsModel:!1,deleteModel:!1,item:{},buffer:!1,toasts:[]}},mounted(){this.checkJWT()},methods:{checkJWT(){if(!this.$store.state.jwt){this.toasts.push({title:"Error",content:"\u767B\u5165\u91D1\u9470\u5DF2\u904E\u671F\uFF0C\u8ACB\u91CD\u65B0\u767B\u5165!"}),this.$router.push("/dashboard");return}C({method:"POST",url:"/auth/checkJWT",headers:{authorization:this.$store.state.jwt}}).then(i=>{i.data.status?this.init():(this.toasts.push({title:"Error",content:"\u767B\u5165\u91D1\u9470\u5DF2\u904E\u671F\uFF0C\u8ACB\u91CD\u65B0\u767B\u5165!"}),this.$router.push("/dashboard"))}).catch(i=>{console.log(i)})},init(){this.pages=0,this.page=1,this.size=5,C({method:"GET",url:"/channel"}).then(i=>{let s=i.data;switch(s.status){case 1:let f=[];s.data.length>=25?this.size=15:this.size=5,s.data.forEach((k,l)=>{k.index=l+1,f.push(k)}),this.data=f,this.data.length/this.size>1?this.pages=Math.ceil(this.data.length/this.size):this.pages=1;break;case 0:this.toasts.push({title:"Error",content:"\u7CFB\u7D71\u932F\u8AA4\uFF0C\u8ACB\u8207\u7BA1\u7406\u8005\u806F\u7E6B"});break}}).catch(i=>{console.log(i)})},showCreateModel(){this.item={channelName:"",description:""},this.createModel=!0},showSettingModel(i){this.item=i,this.settingsModel=!0},showDeleteModel(i){this.item=i,this.deleteModel=!0},createChannel(){if(this.buffer)return;if(this.buffer=!0,this.item.channelName===""){this.toasts.push({title:"Error",content:"\u8ACB\u8F38\u5165\u983B\u9053\u540D\u7A31"}),this.buffer=!1;return}const i={channelName:this.item.channelName,description:this.item.description};C({method:"POST",url:"/channel",data:i,headers:{authorization:this.$store.state.jwt}}).then(s=>{switch(s.data.status){case 1:this.toasts.push({title:"Success",content:"\u65B0\u589E\u6210\u529F"}),this.createModel=!1,this.buffer=!1,this.checkJWT();break;case 0:this.toasts.push({title:"Error",content:"\u7CFB\u7D71\u932F\u8AA4\uFF0C\u8ACB\u8207\u7BA1\u7406\u8005\u806F\u7E6B"}),this.createModel=!1,this.buffer=!1,this.checkJWT();break;case 101:this.toasts.push({title:"Error",content:"\u8CC7\u6599\u683C\u5F0F\u932F\u8AA4\uFF0C\u8ACB\u8207\u7BA1\u7406\u8005\u806F\u7E6B!"}),this.createModel=!1,this.buffer=!1,this.checkJWT();break;case 102:this.toasts.push({title:"Error",content:"ChannelName\u91CD\u8907!"}),this.item.channelName="";break;case 110:this.toasts.push({title:"Error",content:"\u8CC7\u6599\u4E2D\u5B58\u5728\u9055\u898F\u7684\u7279\u6B8A\u7B26\u865F!"}),this.createModel=!1,this.buffer=!1,this.checkJWT();break;case 121:this.toasts.push({title:"Error",content:"JWT\u932F\u8AA4\uFF0C\u8ACB\u91CD\u65B0\u767B\u5165!"}),this.createModel=!1,this.buffer=!1,this.checkJWT();break}}).catch(s=>{this.checkJWT()})},updateChannel(){if(this.buffer)return;if(this.buffer=!0,this.item.channelName==""){this.toasts.push({title:"Error",content:"\u8ACB\u8F38\u5165\u983B\u9053\u540D\u7A31"}),this.buffer=!1;return}const i={id:this.item.id,channelName:this.item.channelName,description:this.item.description};C({method:"PUT",url:"/channel",data:i,headers:{authorization:this.$store.state.jwt}}).then(s=>{switch(s.data.status){case 1:this.toasts.push({title:"Success",content:"\u66F4\u65B0\u6210\u529F"}),this.settingsModel=!1,this.checkJWT();break;case 0:this.toasts.push({title:"Error",content:"\u7CFB\u7D71\u932F\u8AA4\uFF0C\u8ACB\u8207\u7BA1\u7406\u8005\u806F\u7E6B"}),this.settingsModel=!1,this.checkJWT();break;case 101:this.toasts.push({title:"Error",content:"\u8CC7\u6599\u683C\u5F0F\u932F\u8AA4\uFF0C\u8ACB\u8207\u7BA1\u7406\u8005\u806F\u7E6B!"}),this.settingsModel=!1,this.checkJWT();break;case 102:this.toasts.push({title:"Error",content:"Channel\u4E0D\u5B58\u5728\uFF0C\u8ACB\u91CD\u65B0\u64CD\u4F5C!"}),this.settingsModel=!1,this.checkJWT();break;case 103:this.toasts.push({title:"Error",content:"ChannelName\u91CD\u8907!"});break;case 110:this.toasts.push({title:"Error",content:"\u8CC7\u6599\u4E2D\u5B58\u5728\u9055\u898F\u7684\u7279\u6B8A\u7B26\u865F!"}),this.settingsModel=!1,this.checkJWT();break}this.buffer=!1}).catch(s=>{this.checkJWT()})},deleteChannel(){if(this.buffer)return;this.buffer=!0;const i={id:this.item.id};C({method:"Delete",url:"/channel",data:i,headers:{authorization:this.$store.state.jwt}}).then(s=>{switch(s.data.status){case 1:this.toasts.push({title:"Success",content:"\u522A\u9664\u6210\u529F"});break;case 0:this.toasts.push({title:"Error",content:"\u7CFB\u7D71\u932F\u8AA4\uFF0C\u8ACB\u8207\u7BA1\u7406\u8005\u806F\u7E6B"});break;case 101:this.toasts.push({title:"Error",content:"\u8CC7\u6599\u683C\u5F0F\u932F\u8AA4\uFF0C\u8ACB\u8207\u7BA1\u7406\u8005\u806F\u7E6B!"});break;case 102:this.toasts.push({title:"Error",content:"Channel\u4E0D\u5B58\u5728\uFF0C\u8ACB\u91CD\u65B0\u64CD\u4F5C!"});break;case 103:this.toasts.push({title:"Error",content:"Channel\u4F7F\u7528\u4E2D\uFF0C\u4E0D\u5141\u8A31\u522A\u9664\u64CD\u4F5C!"});break;case 110:this.toasts.push({title:"Error",content:"\u8CC7\u6599\u4E2D\u5B58\u5728\u9055\u898F\u7684\u7279\u6B8A\u7B26\u865F!"});break}this.deleteModel=!1,this.buffer=!1,this.checkJWT()}).catch(s=>{this.checkJWT()})}}},A={class:"me-auto fw-bold"};function K(i,s,f,k,l,d){const c=a("CIcon"),u=a("CButton"),g=a("CTableHeaderCell"),J=a("CTableRow"),B=a("CTableHead"),M=a("CTableDataCell"),D=a("CTableBody"),S=a("CTable"),F=a("CPaginationItem"),H=a("CPagination"),P=a("CCardBody"),T=a("CModalTitle"),w=a("CModalHeader"),p=a("CFormLabel"),_=a("CFormInput"),W=a("CModalBody"),N=a("CModalFooter"),E=a("CModal"),U=a("CToastHeader"),I=a("CToastBody"),j=a("CToast"),R=a("CToaster"),L=a("CCard"),X=a("CRow"),O=a("CContainer");return r(),h(O,null,{default:t(()=>[e(X,null,{default:t(()=>[e(L,null,{default:t(()=>[e(P,null,{default:t(()=>[V("h2",null,[o("Channel Management "),e(u,{onClick:s[0]||(s[0]=n=>d.showCreateModel())},{default:t(()=>[e(c,{name:"cil-plus"}),o(" Create ")]),_:1}),e(u,{onClick:s[1]||(s[1]=n=>d.init())},{default:t(()=>[e(c,{name:"cil-sync"}),o(" Update ")]),_:1})]),e(S,{align:"middle",responsive:""},{default:t(()=>[e(B,null,{default:t(()=>[e(J,null,{default:t(()=>[e(g,{scope:"col",class:"w-25"},{default:t(()=>[o("Channel Name")]),_:1}),e(g,{scope:"col",class:"w-25"},{default:t(()=>[o("Description")]),_:1}),e(g,{scope:"col",class:"w-25"})]),_:1})]),_:1}),e(D,null,{default:t(()=>[(r(!0),y(z,null,v(l.data,n=>(r(),h(J,{key:n.index},{default:t(()=>[n.index<=l.page*l.size&&n.index>(l.page-1)*l.size?(r(),h(M,{key:0},{default:t(()=>[o(m(n.channelName),1)]),_:2},1024)):b("",!0),n.index<=l.page*l.size&&n.index>(l.page-1)*l.size?(r(),h(M,{key:1},{default:t(()=>[o(m(n.description),1)]),_:2},1024)):b("",!0),n.index<=l.page*l.size&&n.index>(l.page-1)*l.size?(r(),h(M,{key:2},{default:t(()=>[e(u,{onClick:x=>d.showSettingModel(n)},{default:t(()=>[e(c,{name:"cil-settings"})]),_:2},1032,["onClick"]),e(u,{onClick:x=>d.showDeleteModel(n)},{default:t(()=>[e(c,{name:"cil-trash"})]),_:2},1032,["onClick"])]),_:2},1024)):b("",!0)]),_:2},1024))),128))]),_:1})]),_:1}),l.data.length>0?(r(),h(H,{key:0,align:"end","aria-label":"Page navigation example"},{default:t(()=>[(r(!0),y(z,null,v(l.pages,n=>(r(),h(F,{key:n.index,active:l.page===n,onClick:x=>l.page=n},{default:t(()=>[o(m(n),1)]),_:2},1032,["active","onClick"]))),128))]),_:1})):b("",!0)]),_:1}),e(E,{alignment:"center",size:"lg",visible:l.createModel,onClose:s[6]||(s[6]=()=>{l.createModel=!1})},{default:t(()=>[e(w,null,{default:t(()=>[e(T,null,{default:t(()=>[o("Create Channel")]),_:1})]),_:1}),e(W,null,{default:t(()=>[e(p,null,{default:t(()=>[o("ChannelName")]),_:1}),e(_,{id:"ChannelName",modelValue:l.item.channelName,"onUpdate:modelValue":s[2]||(s[2]=n=>l.item.channelName=n)},null,8,["modelValue"]),e(p,null,{default:t(()=>[o("Description")]),_:1}),e(_,{id:"Description",modelValue:l.item.description,"onUpdate:modelValue":s[3]||(s[3]=n=>l.item.description=n)},null,8,["modelValue"])]),_:1}),e(N,null,{default:t(()=>[e(u,{color:"info",onClick:s[4]||(s[4]=n=>d.createChannel()),disabled:l.buffer},{default:t(()=>[e(c,{name:"cil-plus"}),o(" Create")]),_:1},8,["disabled"]),e(u,{color:"secondary",onClick:s[5]||(s[5]=()=>{l.createModel=!1})},{default:t(()=>[e(c,{name:"cil-X"}),o(" Close ")]),_:1})]),_:1})]),_:1},8,["visible"]),e(E,{alignment:"center",size:"lg",visible:l.settingsModel,onClose:s[11]||(s[11]=()=>{l.settingsModel=!1})},{default:t(()=>[e(w,null,{default:t(()=>[e(T,null,{default:t(()=>[o("Setting Channel")]),_:1})]),_:1}),e(W,null,{default:t(()=>[e(p,null,{default:t(()=>[o("ChannelName")]),_:1}),e(_,{id:"ChannelName",modelValue:l.item.channelName,"onUpdate:modelValue":s[7]||(s[7]=n=>l.item.channelName=n)},null,8,["modelValue"]),e(p,null,{default:t(()=>[o("Description")]),_:1}),e(_,{id:"Description",modelValue:l.item.description,"onUpdate:modelValue":s[8]||(s[8]=n=>l.item.description=n)},null,8,["modelValue"])]),_:1}),e(N,null,{default:t(()=>[e(u,{color:"info",onClick:s[9]||(s[9]=n=>d.updateChannel()),disabled:l.buffer},{default:t(()=>[e(c,{name:"cil-settings"}),o(" Update")]),_:1},8,["disabled"]),e(u,{color:"secondary",onClick:s[10]||(s[10]=()=>{l.settingsModel=!1})},{default:t(()=>[e(c,{name:"cil-X"}),o(" Close ")]),_:1})]),_:1})]),_:1},8,["visible"]),e(E,{size:"sm",alignment:"center",visible:l.deleteModel,onClose:s[14]||(s[14]=()=>{l.deleteModel=!1})},{default:t(()=>[e(w,null,{default:t(()=>[e(T,null,{default:t(()=>[o("Delete Channel")]),_:1})]),_:1}),e(N,null,{default:t(()=>[e(u,{color:"danger",onClick:s[12]||(s[12]=n=>d.deleteChannel()),disabled:l.buffer},{default:t(()=>[e(c,{name:"cil-trash"}),o(" Delete")]),_:1},8,["disabled"]),e(u,{color:"secondary",onClick:s[13]||(s[13]=()=>{l.deleteModel=!1})},{default:t(()=>[e(c,{name:"cil-X"}),o(" Close ")]),_:1})]),_:1})]),_:1},8,["visible"]),e(R,{placement:"top-end"},{default:t(()=>[(r(!0),y(z,null,v(l.toasts,n=>(r(),h(j,{key:n.index,delay:3e3},{default:t(()=>[e(U,{closeButton:""},{default:t(()=>[V("span",A,m(n.title),1)]),_:2},1024),e(I,null,{default:t(()=>[o(m(n.content),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})}const Z=q(G,[["render",K]]);export{Z as default};
